/* product-item/1.0.5 detailNav.js Date:2015-02-05 17:34:29 */
define("product/item/1.0.5/widget/detailNav/detailNav.js",["product/item/1.0.5/js/plugins/jQuery.scroller.js"],function(require){var d=(require("product/item/1.0.5/js/plugins/jQuery.scroller.js",["product/item/1.0.5/js/plugins/jQuery.scroller.js"]),'        <ul class="detail-content-tab">            {for item in navItems}            <li data-id="detail-tag-id-${item.id}" {if item_index==0} class="current"{/if}>                <a href="#none"><i class="arrow-l"><b class="layer1"></b><b class="layer2"></b></i><i class="arrow-r"></i>${item.text}</a>            </li>            {/for}        </ul>'),e=function(a){this.$el=a.$el||$("<div></div>"),this.$wrap=a.$wrap||$("#product-detail"),this.template=a.template||d,this.onStart=a.onStart||function(){},this.onEnd=a.onEnd||function(){},this.targetSelector=a.targetSelector||'[name^="detail-tag-id-"]',this.items=this.$wrap.find(this.targetSelector),this.init()};return e.prototype={init:function(){var a=$(".detail-content");this.items.length>0?(this.$el.show(),a.addClass("z-have-detail-nav"),this.bindEvent(),this.setNavContent()):a.removeClass("z-have-detail-nav")},onScroll:function(){var a=[];function b(a){var b=$(window).height(),c=$("body").scrollTop()||$("html").scrollTop(),d=a.offset().top;return b+c>d&&d>c}if(this.tags.each(function(){var d=$(this);b(d)&&a.push(d)}),a.length>0){var c=a[0].attr("id").replace("detail-tag-id-","");this.listItems.removeClass("current"),this.listItems.filter('[data-id="detail-tag-id-'+c+'"]').addClass("current")}},bindEvent:function(){var a=this;$("body").scroller({onScroll:function(){a.onScroll()}}),this.$el.delegate("li","click",function(){var b=$(this).attr("data-id").replace("detail-tag-id-",""),c=a.$wrap.find("#detail-tag-id-"+b).offset().top;$("body,html").animate({scrollTop:c-50}),log("skupage","cateid",b,G.cat[2],G.cat[1],G.cat[0],G.sku,currentAreaInfo.currentProvinceName,currentAreaInfo.currentCityName)}),this.$el.parent().scroller({delay:10,stopThreshold:$(window).height()-this.$el.height()-$(".J-detail-tab").height(),onStart:function(){a.$el.addClass("fixed-top"),a.onStart(a)},onEnd:function(){a.$el.removeClass("fixed-top"),a.onEnd(a)}})},collectTags:function(){var d,e,a=this.items,b=a.length,c=0,f="\u5bfc\u822a",g={navItems:[]};if(this.tags=a,b>0)for(c;b>c;c++)d=a.eq(c).attr("name"),f=a.eq(c).attr("text"),d&&""!=d&&f&&(e=d.replace("detail-tag-id-",""),g.navItems.push({id:e,text:f}));return g},setNavContent:function(){var a=this.collectTags();this.$el.html(this.template.process(a)),this.listItems=this.$el.find("li")}},e});
